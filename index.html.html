<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CSV to Excel Converter</title>
</head>
<body>
  <h2>CSV to Excel Converter</h2>

  <!-- File input -->
  <input type="file" id="csvFile" accept=".csv" />
  <button onclick="convertCSVToExcel()">Convert to Excel</button>

  <!-- SheetJS library for Excel file creation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <script>
    function convertCSVToExcel() {
      var fileInput = document.getElementById('csvFile');
      var file = fileInput.files[0];

      if (!file) {
        alert("Please select a CSV file first.");
        return;
      }

      var reader = new FileReader();

      reader.onload = function (e) {
        var csvData = e.target.result;
        var rows = csvData.split('\n');
        var data = [];

        // Parse CSV rows into 2D array
        for (var i = 0; i < rows.length; i++) {
          var row = rows[i].trim();
          if (row.length > 0) {
            var columns = row.split(',');
            data.push(columns);
          }
        }

        // Convert array of arrays to worksheet
        var worksheet = XLSX.utils.aoa_to_sheet(data);

        // Create a new workbook and add the worksheet
        var workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "Sheet1");

        // Generate Excel file and trigger download
        XLSX.writeFile(workbook, "converted.xlsx");
      };

      reader.readAsText(file);
    }
  </script>
</body>
</html>
